# DateBase

## 事务

### 特征 (ACID)

1. 原子性(Atomicity)  
    事务中的操作要么全部发生, 要么全部都不发生

2. 一致性(Consistency)
    事务执行前后, 数据的完整性保持一致 且 事务执行前后数据的总和不变

3. 隔离性(Isolation)

    1. 一个事务的执行不能被其他事务干扰, 即一个事务内部的操作 及 使用的数据 对并发的其他事务是 隔离的, 并发执行的各个事务之间不能互相干扰

    2. 两个事务之间是没有交集的

    3. 隔离性与隔离级别是有关的

4. 持久性(Durability)
    事务一旦提交, 对数据库中数据的改变就是永久性的, 直到其他事务将该数据发生修改

### 并发 4 问题

1. 脏写
    多个事务并发写入同一数据时, 先执行的事务所写数据 被后写的数据覆盖

2. 脏读
    一个事务 写入数据 且 未提交/终止, 另一事务便读取到了 写入的数据

3. 不可重复读
    一个事务 对同一数据项进行多次读取, 但是在两次读取间 另一事务修改了该数据项 并 进行了提交, 则 后一次读取到修改, 导致两次读取 信息不一致

4. 幻读
    一个事务 进行两次统计, 但是在两次统计期间 另一事务 添加了新的数据项 并且进行了提交, 则 后一次统计到修改, 导致两次统计信息不一致

### 隔离性

![](https://xiao060.oss-cn-hangzhou.aliyuncs.com/md/202310162058411.png)

## 索引

### B 树

    多叉树, 每个大节点中可以存放多条数据(小节点), 每个小节点会存储 索引信息/数据信息/指向下一个节点的指针, 相比于 二叉树, 可以降低树的高度, 进而较低磁盘 IO 的次数, 减少时间消耗;

    但是 因为 每个而小节点还需要存放数据信息, 导致 每个大节点中存放的小节点个数有限

### B+ 树

    除叶节点外每个节点只会存储 索引/指向下一个节点的指针, 相比于 B 树, 每个大节点中存放的小节点个数更多, 树的高度会更低, IO 次数更少;

    所有的 叶子节点 存储完整的一份 索引信息(Key) 以及 对应的data信息;

    每一个父节点 都出现在子节点中, 是子节点的最大或者最小的元素;

    每个叶子节点都有一个指针, 指向下一个节点, 形成一个链表

### 最左前缀
    